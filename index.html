<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>geography-30 • Unblocked</title>
<meta name="description" content="Unblocked games: 10-column grid with thumbnails, fullscreen player, quiz-66 style settings. Selecting an app changes the site favicon." />

<!-- dynamic favicon targets (will be updated by JS) -->
<link id="fav-ico" rel="icon" href="/favicon.ico" sizes="any">
<link id="fav-apple" rel="apple-touch-icon" href="/apple-touch-icon.png">
<meta name="theme-color" content="#090d13" />

<style>
  :root{ --bg:#090d13; --card:#0f1520; --muted:#9fb1c3; --text:#eef6ff;
         --accent:#2ea8ff; --accent-hover:#58c5ff; --border:rgba(46,168,255,.28); --btn-text:#06121a }
  [data-theme="light"]{ --bg:#f5f8fc; --card:#ffffff; --muted:#5a6a7a; --text:#0b1420;
         --accent:#2a7dff; --accent-hover:#5699ff; --border:rgba(42,125,255,.28); --btn-text:#ffffff }
  [data-theme="amoled"]{ --bg:#000000; --card:#02040a; --muted:#9fb1c3; --text:#e6f1ff;
         --accent:#2ea8ff; --accent-hover:#58c5ff; --border:rgba(46,168,255,.30); --btn-text:#021018 }

  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);
    font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial}
  a{color:inherit;text-decoration:none}

  .wrap{max-width:1680px;margin:0 auto;padding:14px 10px 48px}
  .topbar{display:flex;align-items:center;gap:10px;justify-content:space-between}
  .brand{font-weight:800;letter-spacing:.3px;font-size:18px;white-space:nowrap}
  .actions{display:flex;align-items:center;gap:10px;position:relative;flex-wrap:wrap}

  .btn{
    display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;cursor:pointer;font-size:13px;
    background:linear-gradient(180deg, var(--accent), color-mix(in oklab, var(--accent) 85%, #000 15%));
    color:var(--btn-text); border:1px solid color-mix(in oklab, var(--accent) 70%, #fff 30%);
    box-shadow:0 0 0 rgba(46,168,255,0); transition:box-shadow .18s ease, transform .12s ease, background .18s ease, border-color .18s ease, filter .18s ease;
  }
  .btn:hover{ background:linear-gradient(180deg, var(--accent-hover), color-mix(in oklab, var(--accent-hover) 80%, #000 20%));
    border-color:color-mix(in oklab, var(--accent-hover) 70%, #fff 30%); box-shadow:0 6px 24px rgba(46,168,255,.28), 0 2px 6px rgba(46,168,255,.36); transform:translateY(-1px) }

  /* Grid */
  .grid{display:grid;gap:8px;grid-template-columns:repeat(10,1fr)}
  .card{border:1px solid var(--border);border-radius:12px;overflow:hidden;background:linear-gradient(180deg,#111827,#0c1220);
    display:flex;flex-direction:column;min-height:124px;transition:border-color .18s ease, transform .12s ease, box-shadow .18s ease}
  .card:hover{border-color:color-mix(in oklab,var(--border) 40%, var(--accent) 60%); transform:translateY(-2px); box-shadow:0 8px 22px rgba(46,168,255,.14)}
  .thumb{width:100%;aspect-ratio:calc(4/3 * 1.11);display:flex;align-items:center;justify-content:center;background:radial-gradient(120% 100% at 30% 20%,#1a2740 0%,#0c1220 60%)}
  .thumb img{width:100%;height:100%;object-fit:cover}
  .meta{padding:7px 9px}
  .title{font-size:11.5px;font-weight:800;line-height:1.2;height:27px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
  .badge{display:none}

  .toolbar{display:flex;gap:10px;align-items:center;margin:10px 0 14px;flex-wrap:wrap}
  .input,.select{border:1px solid var(--border);background:var(--card);color:var(--text);padding:8px 11px;border-radius:10px;font-size:13px}
  .counter{margin-left:auto}

  /* Settings panel (quiz-66 style, no quick-link buttons) */
  .panel{position:absolute;top:48px;right:0;min-width:360px;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;display:none;
         box-shadow:0 16px 40px rgba(0,0,0,.35), 0 0 0 1px rgba(46,168,255,.12) inset}
  .panel.open{display:block}
  .panel h4{margin:4px 0 8px;font-size:13px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .appgrid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin:6px 0 10px}
  .app{display:flex;flex-direction:column;align-items:center;gap:6px;border:1px dashed var(--border);border-radius:10px;padding:10px;background:rgba(46,168,255,.06);cursor:pointer}
  .app.active{border-style:solid;background:rgba(46,168,255,.12)}
  .app span{font-size:11px;color:var(--muted)}
  .app svg{width:20px;height:20px;fill:currentColor;color:var(--accent)}

  /* Modal */
  .modal{position:fixed;inset:0;display:none;background:rgba(4,10,18,.66);backdrop-filter:saturate(120%) blur(8px);z-index:40}
  .modal.open{display:flex}
  .sheet{margin:auto;max-width:min(1260px,96vw);width:100%;height:min(77vh,810px);background:var(--card);border:1px solid var(--border);border-radius:16px;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 20px 50px rgba(0,0,0,.5)}
  .pbar{display:flex;align-items:center;justify-content:space-between;padding:9px;border-bottom:1px solid var(--border)}
  .pbtn{border:1px solid var(--border);padding:8px 12px;border-radius:10px;cursor:pointer;font-size:13px;
    background:linear-gradient(180deg, var(--accent), color-mix(in oklab, var(--accent) 85%, #000 15%));color:var(--btn-text);
    box-shadow:0 0 0 rgba(46,168,255,0);transition:box-shadow .18s ease, transform .12s ease, background .18s ease, border-color .18s ease}
  .pbtn:hover{background:linear-gradient(180deg, var(--accent-hover), color-mix(in oklab, var(--accent-hover) 80%, #000 20%));
    border-color:color-mix(in oklab, var(--accent-hover) 70%, #fff 30%);box-shadow:0 6px 24px rgba(46,168,255,.28), 0 2px 6px rgba(46,168,255,.36);transform:translateY(-1px)}
</style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">geography-30 • Unblocked</div>
      <div class="actions">
        <button class="btn" id="btnSettings" aria-haspopup="true" aria-expanded="false">⚙ Settings</button>
        <div class="panel" id="settingsPanel" role="dialog" aria-label="Settings">
          <h4>Appearance</h4>
          <div class="grid2">
            <div>
              <div style="margin-bottom:6px;color:var(--muted);font-size:12px">Theme</div>
              <label style="margin-right:8px"><input type="radio" name="theme" value="dark" checked> Dark</label>
              <label style="margin-right:8px"><input type="radio" name="theme" value="light"> Light</label>
              <label><input type="radio" name="theme" value="amoled"> Amoled</label>
            </div>
            <div>
              <div style="margin-bottom:6px;color:var(--muted);font-size:12px">Site Icon</div>
              <div class="appgrid" id="appGrid">
                <div class="app active" data-app="default" title="Default"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg><span>Default</span></div>
                <div class="app" data-app="classroom" title="Google Classroom"><svg viewBox="0 0 24 24"><rect x="3" y="5" width="18" height="14" rx="2"/></svg><span>Classroom</span></div>
                <div class="app" data-app="google" title="Google"><svg viewBox="0 0 24 24"><path d="M21 12h-9v8"/></svg><span>Google</span></div>
                <div class="app" data-app="drive" title="Drive"><svg viewBox="0 0 24 24"><path d="M7 3l5 0 5 8-5 0z"/></svg><span>Drive</span></div>
                <div class="app" data-app="canvas" title="Canvas"><svg viewBox="0 0 24 24"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Z"/></svg><span>Canvas</span></div>
                <div class="app" data-app="power" title="PowerSchool"><svg viewBox="0 0 24 24"><path d="M6 3h12v18H6z"/></svg><span>Power</span></div>
              </div>
            </div>
          </div>
          <div style="font-size:12px;color:var(--muted);margin-top:6px">Picking an app here only changes the <strong>favicon</strong> of this site. No buttons are added.</div>
        </div>
      </div>
    </div>

    <div class="toolbar">
      <input id="q" class="input" type="search" placeholder="Search…" />
      <select id="catSelect" class="select"><option value="">All categories</option></select>
      <div class="counter muted" id="counter">0 games</div>
    </div>

    <div id="grid" class="grid"></div>
  </div>

  <!-- Player -->
  <div class="modal" id="playerModal" aria-modal="true" role="dialog" aria-label="Game player">
    <div class="sheet">
      <div class="pbar">
        <div class="left">
          <button class="pbtn" id="btnBack">← Close</button>
          <strong id="gameTitle"></strong>
        </div>
        <div class="right">
          <button class="pbtn" id="btnNewTab">New tab</button>
          <button class="pbtn" id="btnFullscreen">Fullscreen</button>
        </div>
      </div>
      <div class="frame"><iframe id="player" class="player" allow="fullscreen" title="Game"></iframe></div>
    </div>
  </div>

<script>
/* ===== Config ===== */
const LSKEY = 'g30_favicon_switcher';
// Favicon endpoints to swap (ICO is enough for most browsers; PNG for apple-touch)
const FAV = {
  default: { ico: '/favicon.ico', apple: '/apple-touch-icon.png' },
  classroom: { ico: 'https://classroom.google.com/favicon.ico', apple: 'https://ssl.gstatic.com/classroom/apple-touch-icon.png' },
  google: { ico: 'https://www.google.com/favicon.ico', apple: 'https://www.google.com/favicon.ico' },
  drive: { ico: 'https://drive.google.com/favicon.ico', apple: 'https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png' },
  canvas: { ico: 'https://canvas.instructure.com/favicon.ico', apple: 'https://canvas.instructure.com/favicon.ico' },
  power: { ico: 'https://www.powerschool.com/wp-content/themes/powerschool/favicon.ico', apple: 'https://www.powerschool.com/wp-content/themes/powerschool/favicon.ico' }
};

/* ===== DOM ===== */
const grid = document.getElementById('grid');
const q = document.getElementById('q');
const catSelect = document.getElementById('catSelect');
const counter = document.getElementById('counter');

const btnSettings = document.getElementById('btnSettings');
const settingsPanel = document.getElementById('settingsPanel');
const appGrid = document.getElementById('appGrid');
const favIco = document.getElementById('fav-ico');
const favApple = document.getElementById('fav-apple');

/* ===== Persist ===== */
function loadS(){ try{ return JSON.parse(localStorage.getItem(LSKEY))||{} }catch{ return {} } }
function saveS(s){ localStorage.setItem(LSKEY, JSON.stringify(s)); }

/* ===== Theme handling ===== */
function applyTheme(theme){
  document.documentElement.setAttribute('data-theme', theme || 'dark');
  document.querySelectorAll('input[name="theme"]').forEach(r => r.checked = (r.value === (theme||'dark')));
}

/* ===== Favicon handling ===== */
function setFavicon(app){
  const map = FAV[app] || FAV.default;
  favIco.href = map.ico;
  favApple.href = map.apple || map.ico;
  // Reflect active tile
  document.querySelectorAll('.app').forEach(a => a.classList.toggle('active', a.dataset.app === app));
}

/* ===== App tile click -> update favicon only ===== */
appGrid.addEventListener('click', (e)=>{
  const tile = e.target.closest('.app');
  if(!tile) return;
  const app = tile.dataset.app;
  const s = loadS();
  s.app = app;
  saveS(s);
  setFavicon(app);
});

/* ===== Settings toggle ===== */
btnSettings.addEventListener('click', ()=>{
  const open = !settingsPanel.classList.contains('open');
  settingsPanel.classList.toggle('open', open);
  btnSettings.setAttribute('aria-expanded', open ? 'true' : 'false');
});

/* ===== Theme radios ===== */
document.querySelectorAll('input[name="theme"]').forEach(r => {
  r.addEventListener('change', ()=>{
    const s = loadS(); s.theme = r.value; saveS(s); applyTheme(s.theme);
  });
});

/* ===== Data ===== */
const FALLBACK = [];
async function loadGames(){
  try{ const res = await fetch('games.json', {cache:'no-store'});
       if(!res.ok) throw new Error('HTTP '+res.status);
       const arr = await res.json();
       return Array.isArray(arr) ? arr : FALLBACK;
  }catch(e){ console.warn('games.json load failed', e); return FALLBACK; }
}

/* ===== Render ===== */
let ALL=[], SHOWN=[];
function cardHTML(g,i){
  const img = g.game_image_icon ? `<img loading="lazy" src="${g.game_image_icon}" alt="${(g.label||'Game').replace(/"/g,'&quot;')}">` : '';
  return `<a class="card" href="#" data-idx="${i}" title="${g.label||''}"><div class="thumb">${img}</div><div class="meta"><div class="title">${g.label||'Game'}</div><span class="badge"></span></div></a>`;
}
function renderGrid(list){ grid.innerHTML = list.map((g,i)=>cardHTML(g,i)).join(''); counter.textContent = list.length + ' games'; }
function populateCats(){ const set = new Set(); ALL.forEach(g => (g.categories||[]).forEach(c => set.add(c)));
  catSelect.innerHTML = ['<option value="">All categories</option>', ...[...set].sort().map(c=>`<option value="${c}">${c}</option>`)].join(''); }
function applyFilters(){ const term=q.value.trim().toLowerCase(), cat=catSelect.value;
  SHOWN = ALL.filter(g => (!cat || (g.categories||[]).includes(cat)) && (!term || (g.label||'').toLowerCase().includes(term)));
  renderGrid(SHOWN);
}

/* ===== Player ===== */
const modal = document.getElementById('playerModal');
const player = document.getElementById('player');
document.addEventListener('click', (e)=>{
  const a = e.target.closest('a.card'); if(!a) return;
  e.preventDefault();
  const g = SHOWN[+a.dataset.idx];
  player.src = g.game_url || 'about:blank';
  document.getElementById('gameTitle').textContent = g.label || 'Game';
  modal.classList.add('open');
});
document.getElementById('btnBack').addEventListener('click', ()=>{ modal.classList.remove('open'); player.src='about:blank'; });
document.getElementById('btnNewTab').addEventListener('click', ()=>{ if(player.src) window.open(player.src,'_blank') });
document.getElementById('btnFullscreen').addEventListener('click', async ()=>{
  const container = player.parentElement;
  if (document.fullscreenElement) await document.exitFullscreen().catch(()=>{});
  else await container.requestFullscreen?.().catch(()=>{});
});
modal.addEventListener('click', (e)=>{ if(e.target === modal) { modal.classList.remove('open'); player.src='about:blank'; }});

/* ===== Init ===== */
(async function(){
  const s = loadS();
  applyTheme(s.theme || 'dark');
  setFavicon(s.app || 'default');

  ALL = await loadGames(); SHOWN = ALL.slice(0);
  populateCats(); renderGrid(SHOWN);

  // Search & filter listeners
  ['change','input'].forEach(ev => q.addEventListener(ev, applyFilters));
  catSelect.addEventListener('change', applyFilters);
})();
</script>
</body>
</html>
